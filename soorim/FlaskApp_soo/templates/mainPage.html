<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3x3 ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    
</head>
<body>
    <div class="main-container">
        <!-- 1ì—´ 1í–‰ - ê·¸ë˜í”„ 2ê°œ -->
        <div class="col1-row1">
            <div class="graph-container">
                <div class="graph-title">ì‹¤ì‹œê°„ ë°ì´í„°</div>
                <canvas id="chart1"></canvas>
            </div>
            <div class="graph-container">
                <div class="graph-title">ë¶„ì„ ì°¨íŠ¸</div>
                <canvas id="chart2"></canvas>
            </div>
        </div>

        <!-- 1ì—´ 2í–‰ - í…ìŠ¤íŠ¸ ì¶œë ¥ ë²„íŠ¼ -->
        <div class="col1-row2">
            <div class="section-title">ì œì–´ ì„¼í„°</div>
            <button class="output-button" onclick="generateOutput()">í…ìŠ¤íŠ¸ ì¶œë ¥</button>
            <button class="output-button" onclick="clearText()" style="background: linear-gradient(45deg, #ff6b6b, #ee5a52);">ì´ˆê¸°í™”</button>
            <button class="output-button" onclick="addMarker()" style="background: linear-gradient(45deg, #2196F3, #1976D2);">ì§€ë„ ë§ˆì»¤</button>
        </div>

        <!-- 1ì—´ 3í–‰ - í…ìŠ¤íŠ¸ í‘œì‹œ -->
        <div class="col1-row3">
            <div class="section-title">ì¶œë ¥ ì˜ì—­</div>
            <div class="text-display" id="textDisplay">
                <div class="log-entry">ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ</div>
                <div class="log-entry">ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ì„¸ìš”</div>
            </div>
        </div>

        <!-- 2ì—´ ì¤‘ê°„ - ì§€ë„ -->
        <div class="col2-map">
            <div class="section-title">ì‹¤ì‹œê°„ ìœ„ì¹˜ ì§€ë„</div>
            <div class="map-container">
                <div class="map-placeholder" id="mapArea">
                    <h3>ğŸ—ºï¸ ì¸í„°ë™í‹°ë¸Œ ë§µ</h3>
                    <iframe src="./obs_map.html" width="600" height="400"></iframe>
                </div>
            </div>
        </div>

        <!-- 3ì—´ ìƒë‹¨ - ëŒ€ì‹œë³´ë“œ -->
        <div class="col3-dashboard">
            <div class="section-title">ì‹œìŠ¤í…œ ëŒ€ì‹œë³´ë“œ</div>
            <div class="dashboard-content">
                <div class="metric-box">
                    <div class="metric-value" id="cpuUsage">45%</div>
                    <div class="metric-label">CPU ì‚¬ìš©ë¥ </div>
                </div>
                
                <div class="metric-box" style="background: linear-gradient(45deg, #4CAF50, #45a049);">
                    <div class="metric-value" id="memoryUsage">67%</div>
                    <div class="metric-label">ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </div>
                </div>
                
                <div class="status-item">
                    <span>ì„œë²„ ìƒíƒœ</span>
                    <span class="status-indicator"></span>
                </div>
                
                <div class="status-item">
                    <span>ë°ì´í„°ë² ì´ìŠ¤</span>
                    <span class="status-indicator" style="background: #ff9800;"></span>
                </div>
                
                <div class="status-item">
                    <span>ë„¤íŠ¸ì›Œí¬</span>
                    <span class="status-indicator"></span>
                </div>

                <h4 style="margin-top: 20px; margin-bottom: 10px;">ì‹¤ì‹œê°„ ì•Œë¦¼</h4>
                <div id="alertLog" style="max-height: 150px; overflow-y: auto;">
                    <div class="log-entry">ìƒˆë¡œìš´ ì‚¬ìš©ì ì—°ê²°</div>
                    <div class="log-entry">ë°ì´í„° ë™ê¸°í™” ì™„ë£Œ</div>
                    <div class="log-entry">ë°±ì—… í”„ë¡œì„¸ìŠ¤ ì‹œì‘</div>
                </div>
            </div>
        </div>
       
            <!-- í•˜ë‹¨ ê·¸ë˜í”„ 3ê°œ ë¬¶ê¸° -->
            <div class="bottom-graphs">
            <!-- Wind Speed -->
            <div class="bottom-graph">
                <div class="section-title">Wind Speed</div>
                <div class="bottom-graph-content" id="windChartWrapper" style="width: 100%; max-width: 1200px; height: 350px;">
                <canvas id="windChart" style="width: 100%; height: 100%; max-height: none;"></canvas>
                </div>
            </div>

            <!-- Sea Speed -->
            <div class="bottom-graph">
                <div class="section-title">Sea Speed</div>
                <div class="bottom-graph-content" id="speedChartWrapper" style="width: 100%; max-width: 1200px; height: 350px;">
                <canvas id="speedChart" style="width: 100%; height: 100%; max-height: none;"></canvas>
                </div>
            </div>

            <!-- Sea High -->
            <div class="bottom-graph">
                <div class="section-title">Sea High</div>
                <div class="bottom-graph-content" id="highChartWrapper" style="width: 100%; max-width: 1200px; height: 350px;">
                <canvas id="highChart" style="width: 100%; height: 100%; max-height: none;"></canvas>
                </div>
            </div>
            </div>

            <!-- Chart.js & PapaParseëŠ” í•œ ë²ˆë§Œ! -->
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
            <script src="/static/js/real-time.js"></script>
        </div>
    </div>

    <script>
        let charts = {};
        let outputCount = 0;
        let markerCount = 3;

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initCharts() {
            // ì°¨íŠ¸ 1 - ë¼ì¸ ì°¨íŠ¸
            const ctx1 = document.getElementById('chart1').getContext('2d');
            charts.chart1 = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['1ë¶„', '2ë¶„', '3ë¶„', '4ë¶„', '5ë¶„', '6ë¶„'],
                    datasets: [{
                        label: 'ì‹¤ì‹œê°„ ê°’',
                        data: [12, 19, 3, 5, 2, 15],
                        borderColor: '#4CAF50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // ì°¨íŠ¸ 2 - ë„ë„› ì°¨íŠ¸
            const ctx2 = document.getElementById('chart2').getContext('2d');
            charts.chart2 = new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: ['ì„±ê³µ', 'ì˜¤ë¥˜', 'ëŒ€ê¸°'],
                    datasets: [{
                        data: [75, 15, 10],
                        backgroundColor: ['#4CAF50', '#f44336', '#ff9800']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { font: { size: 10 } } } }
                }
            });

            // ì°¨íŠ¸ 3 - ë°” ì°¨íŠ¸
            const ctx3 = document.getElementById('chart3').getContext('2d');
            charts.chart3 = new Chart(ctx3, {
                type: 'bar',
                data: {
                    labels: ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'],
                    datasets: [{
                        label: 'ë°©ë¬¸ì',
                        data: [120, 190, 300, 250, 220],
                        backgroundColor: '#2196F3'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });

            // ì°¨íŠ¸ 4 - ë ˆì´ë” ì°¨íŠ¸
            const ctx4 = document.getElementById('chart4').getContext('2d');
            charts.chart4 = new Chart(ctx4, {
                type: 'radar',
                data: {
                    labels: ['ì†ë„', 'ì•ˆì •ì„±', 'ë³´ì•ˆ', 'ì‚¬ìš©ì„±', 'í™•ì¥ì„±'],
                    datasets: [{
                        label: 'ì„±ëŠ¥',
                        data: [80, 90, 75, 85, 70],
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { r: { beginAtZero: true, max: 100 } }
                }
            });

            // ì°¨íŠ¸ 5 - í´ë¼ ì°¨íŠ¸
            const ctx5 = document.getElementById('chart5').getContext('2d');
            charts.chart5 = new Chart(ctx5, {
                type: 'polarArea',
                data: {
                    labels: ['ëª¨ë°”ì¼', 'ë°ìŠ¤í¬í†±', 'íƒœë¸”ë¦¿'],
                    datasets: [{
                        data: [300, 150, 50],
                        backgroundColor: ['#4CAF50', '#2196F3', '#ff9800']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { font: { size: 10 } } } }
                }
            });
        }

        // í…ìŠ¤íŠ¸ ì¶œë ¥ í•¨ìˆ˜
        function generateOutput() {
            outputCount++;
            const textDisplay = document.getElementById('textDisplay');
            const newEntry = document.createElement('div');
            newEntry.className = 'log-entry';
            newEntry.textContent = `[${new Date().toLocaleTimeString()}] ì¶œë ¥ #${outputCount}: ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ`;
            textDisplay.appendChild(newEntry);
            textDisplay.scrollTop = textDisplay.scrollHeight;

            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard();
        }

        function clearText() {
            document.getElementById('textDisplay').innerHTML = '<div class="log-entry">ì¶œë ¥ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</div>';
        }

        function addMarker() {
            const mapArea = document.getElementById('mapArea');
            const marker = document.createElement('div');
            marker.className = 'map-marker';
            marker.style.top = Math.random() * 70 + '%';
            marker.style.left = Math.random() * 70 + '%';
            marker.style.background = ['#ff4444', '#4CAF50', '#ff9800', '#2196F3'][Math.floor(Math.random() * 4)];
            mapArea.appendChild(marker);
            
            markerCount++;
            addLog(`ìƒˆë¡œìš´ ë§ˆì»¤ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. (ì´ ${markerCount}ê°œ)`);
        }

        function updateDashboard() {
            document.getElementById('cpuUsage').textContent = Math.floor(Math.random() * 40 + 30) + '%';
            document.getElementById('memoryUsage').textContent = Math.floor(Math.random() * 30 + 50) + '%';
            
            // ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
            Object.values(charts).forEach(chart => {
                if (chart.data.datasets[0].data) {
                    chart.data.datasets[0].data = chart.data.datasets[0].data.map(() => 
                        Math.floor(Math.random() * 100)
                    );
                    chart.update();
                }
            });
        }

        function addLog(message) {
            const alertLog = document.getElementById('alertLog');
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            alertLog.insertBefore(logEntry, alertLog.firstChild);
            
            // ìµœëŒ€ 10ê°œ í•­ëª©ë§Œ ìœ ì§€
            while (alertLog.children.length > 10) {
                alertLog.removeChild(alertLog.lastChild);
            }
        }

        // ì´ˆê¸°í™”
        window.onload = function() {
            initCharts();
            setInterval(updateDashboard, 3000); // 3ì´ˆë§ˆë‹¤ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        };
    </script>
</body>
</html>